{% extends 'webshop/site/base-site.html.twig' %}

{%- block title -%}
    AJAX FORM | 	{{ parent() }}
{%- endblock -%}



{% block stylesheets %}
    {{ parent() }}
{% endblock %}

{% block page_content %}



	<!-- Product detail -->
	<section class="product-details">
		<div class="container mb-4" id="container">
			<div class="row">
				<div class="col-lg-12 pt-4 JS--wrapper">

                    <div class="JS--resultWrapper d-none">
                    </div>

                    <div class="JS--formWrapper">
                        {{ include('webshop/cart/recipient_form.html.twig') }}
                    </div>



				</div>
			</div>
		</div>
	</section>


{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $(document).ready(function () {
            var $wrapper = $('.JS--wrapper');
            var inlineEdit = new InlineEdit($wrapper);
        });
//        /**
//         * Removes an entry from a table with AJAX
//         *
//         *   - Delete button must have the 'js--button-delete' class.
//         *   - Enclosing DOM element must have the 'js--wrapper' class.
//         *   - Delete button must have the 'data-url' attribute which holds the URL where the request is sent.
//         *   - URL must be defined on the server side
//         */
//        'use strict';
//
//        (function(window, $) {
//            window.DeleteAction = function ($wrapper) {
//                this.$wrapper = $wrapper;
//                /**
//                 * itt elobb megtalalja a DOM elemet, majd azon csekkolja van-e valamilyen event
//                 * Here the listener is attached to DOM elements
//                 */
////                this.$wrapper.find('.js--button-delete').on('click', this.handleDelete.bind(this));
////                this.$wrapper.find('.js--form-new').on('submit', this.handleFormSubmit.bind(this));
//
//                /**
//                 * Here the listener is attached to element that wraps the DOM elements
//                 *
//                 * So, whenever a click event bubbles up to $wrapper, checks to see if any elements inside of it
//                 * with a 'js--something' were also clicked. If they were, fires this function! And have a great day!
//                 */
//                this.$wrapper.on('click','.js--button-delete', this.handleDelete.bind(this));
//                this.$wrapper.on('submit','.js--form-new', this.handleFormSubmit.bind(this));
//                this.$wrapper.find('tbody tr').on('click', this.handleRowClick.bind(this));
//
//            };
//
//            $.extend(window.DeleteAction.prototype, {
//
//                handleFormSubmit: function(event) {
//                    event.preventDefault();
//                    var $form = $(event.currentTarget);
//
//                    $.ajax({
//                        url: $form.attr('action'),
//                        method: 'POST',
//                        data: $form.serialize(),
//                        success: function(data) {
//                            $form.closest('.js--wrapper-form').html(data);
//                        },
//                        error: function(jqXHR) {
//                            $form.closest('.js--wrapper-form').html(jqXHR.responseText);
//                        }
//                    });
//
//                    console.log($(event.currentTarget)+' submitting...');
//                },
//
//                handleDelete: function(event) {
//                    event.preventDefault();
//                    var $element = $(event.currentTarget);
//                    $element.addClass('text-danger');
//                    $element.find('.fas')
//                        .removeClass('fa-trash')
//                        .addClass('fa-spinner')
//                        .addClass('fa-spin');
//
//                    var url = $element.data('url');
//                    var $row = $element.closest('tr');
//
//                    var self = this;
//
//                    $.ajax({
//                        url: url,
//                        method: 'DELETE',
//                        success: function() {
//                            $row.fadeOut('normal', function() {
////                                $row.remove();
////                                az alabbival ugyanaz
//                                $(this).remove();
//                            });
//                        }
//                    });
//                },
//
//                handleRowClick: function() {
//                    console.log('row clicked');
//                }
//
//            });
//        })(window, jQuery);
//
//
//        $(document).ready(function () {
//            var $wrapper = $('.js--wrapper');
//            var deleteAction = new DeleteAction($wrapper);
//        });
//
//        //        $(document).ready(function () {
//        //            // ha var-ba rakom gyorsabb a feldolgozas
//        //            // a $ jel a $table-ben sima karakter es azt jelzi, hogy jQuery obiektumrol van szo, amin lehet find() metodust alkalmazni
//        //            var $table = $('.js--invoice-table');
//        //
//        //            // csak a $table-ben fogja keresni
//        //            $table.find('.js--invoice-delete-button').on('click', function (event) {
//        //                event.preventDefault();
//        //
//        //                //$(event.currentTarget).addClass('text-danger');
//        //                // above line is  equivalent to this
//        //                // this is just a shortcut to e.currentTarget
//        //                $(this).addClass('text-danger');
//        //                $(this).find('.fas')
//        //                    .removeClass('fa-trash')
//        //                    .addClass('fa-spinner')
//        //                    .addClass('fa-spin');
//        //
//        //                var url = $(this).data('url');
//        //                var $row = $(this).closest('tr');
//        //
//        //                $.ajax({
//        //                    url: url,
//        //                    method: 'DELETE',
//        //                    success: function() {
//        //                        $row.fadeOut();
//        //                    }
//        //                });
//        //
//        ////                console.log(event.currentTarget === this);
//        ////                return false;
//        //            });
//        //
//        //            // csak a $table-ben fogja keresni
//        //            $table.find('tbody tr').on('click', function(event) {
//        //                event.preventDefault();
//        ////                $(event.target).addClass('bg-warning');
//        ////                console.dir(event.target);
//        //                console.log('row clicked');
//        //            });
//        //        });
    </script>

{% endblock %}
